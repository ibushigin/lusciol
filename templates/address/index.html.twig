{% extends 'base.html.twig' %}

{% block title %}Hello AddressController!{% endblock %}

{% block body %}
    <div id="test">test</div>
    <div id="map"></div>

    <p>
        {% for key, latitude in locations_lat %}
            Latitude{{ key }} : {{ latitude }}
        {% endfor %}
        <br>
        {% for key, longitude in locations_long %}
            Longitude{{ key }} : {{ longitude }}
        {% endfor %}


    </p>


    {% for item in address %}
        <article>

            {#{{ dump(item) }}#}
            <strong>Nom :</strong> {{ item.name }}<br>
            <strong>Sous-Categorie :</strong> {{ item.subCategory.label }}<br>
            <strong>Categorie :</strong> {{ item.subCategory.category.label }}<br>
            <strong>Adresse :</strong> {{ item.location }}<br>
            <strong>Coordoonées géographiques :</strong> {{ item.coordinates }}<br>
            <strong>Tel :</strong> {{ item.tel }}<br>
            <strong>Site internet :</strong> {{ item.website }}<br>
            <strong>Réduction :</strong> {{ item.discount }}<br>
            <strong>Statut :</strong> {{ item.status }}<br>
            <hr>
        </article>

    {% endfor %}

{% endblock %}

{% block javascripts %}
    {{ parent() }}
    {#<script src="{{ asset('js/map.js') }}"></script>#}
    <script>
        $(function(){
            let osmUrl = 'https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',
                osmAttrib = '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',
                osm = L.tileLayer(osmUrl, {maxZoom: 18, attribution: osmAttrib});
            let map = L.map('map').setView([44.8397534, -0.5739364], 14);

            L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token={accessToken}', {
                attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery © <a href="https://www.mapbox.com/">Mapbox</a>',
                maxZoom: 18,
                id: 'mapbox.streets',
                accessToken: 'pk.eyJ1IjoiaWJ1c2hpZ2luIiwiYSI6ImNqcXJ1d3lwdjBnZXo0MmxqZWRyMGIzdmEifQ.MAtmFHO16MD5osbZotlXYw'
            }).addTo(map);


            map.locate({setView: true, maxZoom: 16});



            {% for key, latitude in locations_lat %}
                let latitude{{ key }} = {{ latitude }}
            {% endfor %}

            {% for key, longitude in locations_long %}
                    let longitude{{ key }} = {{ longitude }}
            {% endfor %}

                {% set nbAddress = nbAddress-1 %}

            {% for i in 0..nbAddress %}
                var marker{{ i }} = L.marker([latitude{{ i }}, longitude{{ i }}]).addTo(map);
            {% endfor %}


        });
    </script>
{% endblock %}
